<!DOCTYPE HTML>
<html>
  <head>
    <title>Project Stalwart</title>    
  </head>
  <body master>
    <h1 insert-me='insert-me1' insert-value='master.fruit'>
      <div insert-me='should-not-be-called' insert-value='ignore me please'></div>
    </h1>
    <div insert-me='wtf?' insert-value='wooloo' silly></div>
    <h1 bind-to='master.value'>Hello World</h1>
  </body>

  <script src="../tests/external/jquery-2.1.4.js" type='text/javascript'></script>
  <!-- Inject all Stalwart Modules -->
  <!-- In production should use one min file -->
  <script src='../stalwart/stalwart.js' type='text/javascript'></script>
  <script src='../stalwart/trigger.js' type='text/javascript'></script>
  <script src='../stalwart/utils.js' type='text/javascript'></script>
  <script src='../stalwart/class.js' type='text/javascript'></script>
  <script src='../stalwart/handler.js' type='text/javascript'></script>

  <script type="text/javascript">
    sW.Handler.Handler('master', {}, function(element, args, parents){
      this.fruit = 'apple';
      console.log(this);
    });
    sW.Handler.Handler('insert-me',
                       {
                        'silly': '?',
                        'insert-value': '@=?'
                       },
                       function(element, args, parents){
                        //since this could be a bindable arg or a literal, let's check
                        if (this.bindable('insert-value')){
                          this.bindArg('insert_value', 'insert-value');
                        } else {
                          this.insert_value = args['insert-value'];
                        }
                        //set values, also set up a listener to update this
                        //if this were an input that can change the value we would
                        //need to handle that as well
                        var makeMyString = function(value){
                          var t = 'my value is: '+value;
                          if (args.silly){
                            t += '<br/>and I am silly';
                          } else {
                            t += '<br/>and I am sad... :(';
                          }
                          return t;
                        }
                        element.html(makeMyString(this.insert_value));
                        this.listen('insert_value', function(value){
                          element.html(makeMyString(value));
                        });
                      });
    sW.onInit(function(){
      console.log('all loaded');
      console.log(sW.Handler.allHandlers);
      sW.Handler.runHandlers();
    });
  </script>
</html>
